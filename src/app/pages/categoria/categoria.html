<section class="categoria-page">

  <!-- BREADCRUMB -->
  <nav class="breadcrumb" *ngIf="breadcrumbs.length">
    <button
      type="button"
      class="crumb"
      *ngFor="let c of breadcrumbs; let last = last"
      [class.last]="last"
      [disabled]="last"
      (click)="!last && navegarCrumb(c.action)"
    >
      <span *ngIf="c.action === 'home'">üè†</span>
      <span *ngIf="c.action !== 'home'">{{ c.label }}</span>
      <span class="sep" *ngIf="!last">/</span>
    </button>
  </nav>

  <!-- CHIPS NIVEL 1 -->
  <div class="chips-box">
    <div class="chips">
      <button
        type="button"
        class="chip"
        [class.active]="grupoActivo === 'Todos'"
        (click)="seleccionarGrupo('Todos')"
      >
        Todos
      </button>

      <button
        type="button"
        class="chip"
        *ngFor="let g of grupos"
        [class.active]="grupoActivo === g.nombre"
        (click)="seleccionarGrupo(g.nombre)"
      >
        {{ g.nombre }}
      </button>
    </div>
  </div>

  <!-- CHIPS NIVEL 2 -->
  <div class="chips-box" *ngIf="subitems.length">
    <div class="chips">
      <button
        type="button"
        class="chip chip-sec"
        *ngFor="let s of subitems"
        [class.active]="subitemActivo === s"
        (click)="seleccionarSubitem(s)"
      >
        {{ s }}
      </button>
    </div>
  </div>

 <!-- LOADING -->
<div *ngIf="loading" class="loading">
  Cargando productos...
</div>

<!-- SIN RESULTADOS -->
<div *ngIf="!loading && productos.length === 0" class="empty">
  No hay productos para este filtro.
</div>

<!-- GRID PRODUCTOS -->
<div class="productos-grid" *ngIf="!loading && productos.length > 0">

  <article
    class="producto-card"
    *ngFor="let p of productos"
    (click)="verProducto(p.id)"
  >
    <div class="producto-img">
      <img [src]="p.imagen || 'img/placeholder.png'" [alt]="p.nombre" />
      <span class="badge badge-nuevo" *ngIf="p.es_nuevo">Nuevo</span>
      <span class="badge badge-oferta" *ngIf="p.en_oferta">Oferta</span>
    </div>

    <div class="producto-info">
      <h3>{{ p.nombre }}</h3>
      <p class="desc">{{ p.descripcion }}</p>

      <div class="precio-row">
        <div class="precios">
          <span class="precio">
            {{ p.precio | currency:'$  ':'symbol':'1.0-0' }}
          </span>

          <span
            class="precio-antes"
            *ngIf="p.en_oferta && p.precio_antes"
          >
            {{ p.precio_antes | currency:'$  ':'symbol':'1.0-0' }}
          </span>
        </div>

        <button
          type="button"
          class="btn-add"
          (click)="addToCart(p); $event.stopPropagation()"
        >
          Agregar
        </button>
      </div>
    </div>
  </article>
</div>


  <!-- PAGINACI√ìN -->
  <div class="paginacion" *ngIf="!loading && totalPages > 1">

    <button
      class="pag-btn"
      (click)="prevPage()"
      [disabled]="page === 1"
    >
      ‚Üê
    </button>
    <div class="pag-numeros">
      <button
        class="pag-num"
        *ngFor="let p of paginasVisibles"
        [disabled]="p === -1"
        [class.active]="p === page"
        (click)="p !== -1 && goToPage(p)"
      >
        {{ p === -1 ? '‚Ä¶' : p }}
      </button>
    </div>

    <button
      class="pag-btn"
      (click)="nextPage()"
      [disabled]="page === totalPages"
    >
      ‚Üí
    </button>
  </div>
</section>
